<html>
    <body>
        <script>
        (function() {
            function receiveMessage(e) {
                let params = new URLSearchParams(window.location.search);
                let message = params.get('message');
                let code = params.get('code');
                console.log("code: %o", code)
                console.log("message: %o", message)

                console.log("receiveMessage", "https://scones.fly.dev")
                window.opener.postMessage(
                    'authorization:github:${message}:${JSON.stringify(code)}',
                    "https://scones.fly.dev"
                )
                window.removeEventListener("message",receiveMessage,false);
            }
            window.addEventListener("message", receiveMessage, false)
            console.log("Sending message: %o", "github")
            window.opener.postMessage("authorizing:github", "*")
        })()
        </script>
        <p>Login successful, redirecting</p>
    </body>
</html>
